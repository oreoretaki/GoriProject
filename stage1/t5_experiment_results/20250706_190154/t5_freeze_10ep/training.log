[rank: 0] Seed set to 42
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loading `train_dataloader` to estimate number of stepping batches.
🚀 Stage 1 訓練開始
   設定ファイル: configs/t5_freeze_10ep.yaml
   データディレクトリ: ../data/derived
   デバイス数: 1
📊 データローダー作成中...
🔄 Stage 1 Dataset初期化 (train)
   データディレクトリ: ../data/derived
   時間足: ['m1', 'm5', 'm15', 'm30', 'h1', 'h4']
   シーケンス長: 128
   M1: 3,104,383レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:24:00+00:00
   M5: 630,474レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:20:00+00:00
   M15: 210,477レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:15:00+00:00
   M30: 105,252レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H1: 52,632レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H4: 13,601レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 20:00:00+00:00
🔧 FeatureEngineer初期化
   特徴量数: 6
   特徴量: ['open', 'high', 'low', 'close', 'delta_close', 'body_ratio']
📏 TFNormalizer初期化
   統計ファイル: ../data/derived/stats.json
   キャッシュ有効: True
📂 正規化統計ロード完了: 2個のTF
🔄 MultiTFWindowSampler初期化 (train)
   📂 キャッシュからウィンドウ読み込み: windows_d4ec0e80.npy
   ⚡ ウィンドウ処理時間: 26.16秒
   総ウィンドウ数: 3104256
   trainウィンドウ数: 2483405
🎭 MaskingStrategy初期化
   マスク率: 0.15
   スパン範囲: 3-10
   TF間同期: True
🔄 Stage 1 Dataset初期化 (val)
   データディレクトリ: ../data/derived
   時間足: ['m1', 'm5', 'm15', 'm30', 'h1', 'h4']
   シーケンス長: 128
   M1: 3,104,383レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:24:00+00:00
   M5: 630,474レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:20:00+00:00
   M15: 210,477レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:15:00+00:00
   M30: 105,252レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H1: 52,632レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H4: 13,601レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 20:00:00+00:00
🔧 FeatureEngineer初期化
   特徴量数: 6
   特徴量: ['open', 'high', 'low', 'close', 'delta_close', 'body_ratio']
📏 TFNormalizer初期化
   統計ファイル: ../data/derived/stats.json
   キャッシュ有効: True
📂 正規化統計ロード完了: 2個のTF
🔄 MultiTFWindowSampler初期化 (val)
   📂 キャッシュからウィンドウ読み込み: windows_d4ec0e80.npy
   ⚡ ウィンドウ処理時間: 45.05秒
   総ウィンドウ数: 3104256
   valウィンドウ数: 620851
🎭 MaskingStrategy初期化
   マスク率: 0.15
   スパン範囲: 3-10
   TF間同期: True
📊 DataLoader作成完了
   訓練: 77606バッチ (2483405サンプル)
   検証: 19401バッチ (620851サンプル)
   最適化: num_workers=3, prefetch=4
🧠 モデル初期化中...
🤗 T5転移学習を使用します
🤗 T5エンコーダーをロード中: t5-small
🔒 T5エンコーダーを凍結しました
✅ T5TimeSeriesAdapter初期化完了
   T5 d_model: 512
   Stage-1 d_model: 64
   Patch length: 32
   初期凍結エポック数: 2
🎯 Stage1CombinedLoss初期化
   損失重み: {'recon_tf': 0.6, 'spec_tf': 0.2, 'cross': 0.15, 'amp_phase': 0.05}
⚡ Stage1LightningModule初期化完了
   モデル情報: {'total_parameters': 36763560, 'trainable_parameters': 1432744, 'model_size_mb': 140.24185180664062, 'architecture': {'n_tf': 6, 'seq_len': 128, 'n_features': 6, 'd_model': 64, 'latent_len': 'dynamic(16)'}}
🤗 T5段階的解凍コールバックを追加 (freeze_epochs=2)
🤗 T5差分学習率を適用: base_lr=1.00e-03, t5_lr=1.00e-05

  | Name      | Type               | Params | Mode 
---------------------------------------------------------
0 | model     | Stage1Model        | 36.8 M | train
1 | criterion | Stage1CombinedLoss | 0      | train
---------------------------------------------------------
1.4 M     Trainable params
35.3 M    Non-trainable params
36.8 M    Total params
147.054   Total estimated model params size (MB)
102       Modules in train mode
115       Modules in eval mode
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:08<00:00,  0.23it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/100 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/100 [00:00<?, ?it/s] Epoch 0:  10%|█         | 10/100 [00:24<03:43,  0.40it/s]Epoch 0:  10%|█         | 10/100 [00:24<03:43,  0.40it/s, lr=2.65e-04]Epoch 0:  20%|██        | 20/100 [00:51<03:24,  0.39it/s, lr=2.65e-04]Epoch 0:  20%|██        | 20/100 [00:51<03:24,  0.39it/s, lr=4.62e-04]Epoch 0:  30%|███       | 30/100 [01:16<02:59,  0.39it/s, lr=4.62e-04]Epoch 0:  30%|███       | 30/100 [01:16<02:59,  0.39it/s, lr=7.14e-04]Epoch 0:  40%|████      | 40/100 [01:43<02:34,  0.39it/s, lr=7.14e-04]Epoch 0:  40%|████      | 40/100 [01:43<02:34,  0.39it/s, lr=9.21e-04]Epoch 0:  50%|█████     | 50/100 [02:11<02:11,  0.38it/s, lr=9.21e-04]Epoch 0:  50%|█████     | 50/100 [02:11<02:11,  0.38it/s, lr=1.00e-03]Epoch 0:  60%|██████    | 60/100 [02:34<01:43,  0.39it/s, lr=1.00e-03]Epoch 0:  60%|██████    | 60/100 [02:34<01:43,  0.39it/s, lr=1.00e-03]Epoch 0:  70%|███████   | 70/100 [02:52<01:13,  0.41it/s, lr=1.00e-03]Epoch 0:  70%|███████   | 70/100 [02:52<01:13,  0.41it/s, lr=9.99e-04]Epoch 0:  80%|████████  | 80/100 [03:21<00:50,  0.40it/s, lr=9.99e-04]Epoch 0:  80%|████████  | 80/100 [03:21<00:50,  0.40it/s, lr=9.98e-04]Epoch 0:  90%|█████████ | 90/100 [03:49<00:25,  0.39it/s, lr=9.98e-04]Epoch 0:  90%|█████████ | 90/100 [03:49<00:25,  0.39it/s, lr=9.96e-04]Epoch 0: 100%|██████████| 100/100 [04:25<00:00,  0.38it/s, lr=9.96e-04]Epoch 0: 100%|██████████| 100/100 [04:25<00:00,  0.38it/s, lr=9.93e-04]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:28<00:28,  0.35it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [01:00<00:00,  0.33it/s][A
                                                                        [AEpoch 0: 100%|██████████| 100/100 [05:26<00:00,  0.31it/s, val_loss_ep=217.5600, val_loss=218.7882, val_corr_ep=+0.009, val_corr=+0.057, lr=9.93e-04]Epoch 0: 100%|██████████| 100/100 [05:26<00:00,  0.31it/s, val_loss_ep=217.5600, val_loss=218.7882, val_corr_ep=+0.009, val_corr=+0.057, lr=9.93e-04]⚠️ AMPスケールが大幅に減少: 65536.0 → 128.0
Epoch 0:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=217.5600, val_loss=218.7882, val_corr_ep=+0.009, val_corr=+0.057, lr=9.93e-04]          Epoch 1:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=217.5600, val_loss=218.7882, val_corr_ep=+0.009, val_corr=+0.057, lr=9.93e-04]Epoch 1:  10%|█         | 10/100 [01:42<15:18,  0.10it/s, val_loss_ep=217.5600, val_loss=218.7882, val_corr_ep=+0.009, val_corr=+0.057, lr=9.93e-04]Epoch 1:  10%|█         | 10/100 [01:42<15:18,  0.10it/s, val_loss_ep=217.5600, val_loss=218.7882, val_corr_ep=+0.009, val_corr=+0.057, lr=9.90e-04]