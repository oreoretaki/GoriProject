[rank: 0] Seed set to 42
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loading `train_dataloader` to estimate number of stepping batches.
🚀 Stage 1 訓練開始
   設定ファイル: configs/t5_nofreeze.yaml
   データディレクトリ: ../data/derived
   デバイス数: 1
📊 データローダー作成中...
🔄 Stage 1 Dataset初期化 (train)
   データディレクトリ: ../data/derived
   時間足: ['m1', 'm5', 'm15', 'm30', 'h1', 'h4']
   シーケンス長: 64
   M1: 3,104,383レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:24:00+00:00
   M5: 630,474レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:20:00+00:00
   M15: 210,477レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:15:00+00:00
   M30: 105,252レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H1: 52,632レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H4: 13,601レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 20:00:00+00:00
🔧 FeatureEngineer初期化
   特徴量数: 6
   特徴量: ['open', 'high', 'low', 'close', 'delta_close', 'body_ratio']
📏 TFNormalizer初期化
   統計ファイル: ../data/derived/stats.json
   キャッシュ有効: True
📂 正規化統計ロード完了: 2個のTF
🔄 MultiTFWindowSampler初期化 (train)
   📂 キャッシュからウィンドウ読み込み: windows_0ef31b94.npy
   ⚡ ウィンドウ処理時間: 22.92秒
   総ウィンドウ数: 3104320
   trainウィンドウ数: 2483456
🎭 MaskingStrategy初期化
   マスク率: 0.15
   スパン範囲: 3-10
   TF間同期: True
🔄 Stage 1 Dataset初期化 (val)
   データディレクトリ: ../data/derived
   時間足: ['m1', 'm5', 'm15', 'm30', 'h1', 'h4']
   シーケンス長: 64
   M1: 3,104,383レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:24:00+00:00
   M5: 630,474レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:20:00+00:00
   M15: 210,477レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:15:00+00:00
   M30: 105,252レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H1: 52,632レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H4: 13,601レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 20:00:00+00:00
🔧 FeatureEngineer初期化
   特徴量数: 6
   特徴量: ['open', 'high', 'low', 'close', 'delta_close', 'body_ratio']
📏 TFNormalizer初期化
   統計ファイル: ../data/derived/stats.json
   キャッシュ有効: True
📂 正規化統計ロード完了: 2個のTF
🔄 MultiTFWindowSampler初期化 (val)
   📂 キャッシュからウィンドウ読み込み: windows_0ef31b94.npy
   ⚡ ウィンドウ処理時間: 21.83秒
   総ウィンドウ数: 3104320
   valウィンドウ数: 620864
🎭 MaskingStrategy初期化
   マスク率: 0.15
   スパン範囲: 3-10
   TF間同期: True
📊 DataLoader作成完了
   訓練: 51738バッチ (2483456サンプル)
   検証: 12934バッチ (620864サンプル)
   最適化: num_workers=3, prefetch=2
🧠 モデル初期化中...
🤗 T5転移学習を使用します
⚠️ google/t5-smallをダウンロードできません。デフォルト設定を使用します。
🤗 T5エンコーダーをロード中: google/t5-small
⚠️ T5エンコーダーをダウンロードできません。ランダム初期化T5を作成します。
🔒 T5エンコーダーを凍結しました
✅ T5TimeSeriesAdapter初期化完了
   T5 d_model: 512
   Stage-1 d_model: 64
   Patch length: 16
   初期凍結エポック数: 0
🎯 Stage1CombinedLoss初期化
   損失重み: {'recon_tf': 0.6, 'spec_tf': 0.2, 'cross': 0.15, 'amp_phase': 0.05}
⚡ Stage1LightningModule初期化完了
   モデル情報: {'total_parameters': 36448168, 'trainable_parameters': 1117352, 'model_size_mb': 139.03872680664062, 'architecture': {'n_tf': 6, 'seq_len': 64, 'n_features': 6, 'd_model': 64, 'latent_len': 'dynamic(16)'}}
🤗 T5段階的解凍コールバックを追加 (freeze_epochs=0)
🤗 T5差分学習率を適用: base_lr=3.00e-04, t5_lr=3.00e-05

  | Name      | Type               | Params | Mode 
---------------------------------------------------------
0 | model     | Stage1Model        | 36.4 M | train
1 | criterion | Stage1CombinedLoss | 0      | train
---------------------------------------------------------
1.1 M     Trainable params
35.3 M    Non-trainable params
36.4 M    Total params
145.793   Total estimated model params size (MB)
217       Modules in train mode
0         Modules in eval mode
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:04<00:00,  0.42it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/100 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/100 [00:00<?, ?it/s] 🔓 T5エンコーダーの凍結を解除しました
🔓 エポック0: T5エンコーダーの凍結を解除
Epoch 0:  10%|█         | 10/100 [00:10<01:34,  0.96it/s]Epoch 0:  10%|█         | 10/100 [00:10<01:34,  0.95it/s, lr=3.84e-05, grad_norm=1.47e+05, amp=0]Epoch 0:  20%|██        | 20/100 [00:20<01:22,  0.97it/s, lr=3.84e-05, grad_norm=1.47e+05, amp=0]Epoch 0:  20%|██        | 20/100 [00:20<01:22,  0.97it/s, lr=6.24e-05, grad_norm=1.46e+05, amp=0]Epoch 0:  30%|███       | 30/100 [00:29<01:07,  1.03it/s, lr=6.24e-05, grad_norm=1.46e+05, amp=0]Epoch 0:  30%|███       | 30/100 [00:29<01:07,  1.03it/s, lr=1.21e-04, grad_norm=1.48e+05, amp=0]Epoch 0:  40%|████      | 40/100 [00:37<00:55,  1.07it/s, lr=1.21e-04, grad_norm=1.48e+05, amp=0]Epoch 0:  40%|████      | 40/100 [00:37<00:55,  1.07it/s, lr=1.68e-04, grad_norm=1.44e+05, amp=0]Epoch 0:  50%|█████     | 50/100 [00:45<00:45,  1.09it/s, lr=1.68e-04, grad_norm=1.44e+05, amp=0]Epoch 0:  50%|█████     | 50/100 [00:45<00:45,  1.09it/s, lr=2.36e-04, grad_norm=1.46e+05, amp=0]Epoch 0:  60%|██████    | 60/100 [00:56<00:37,  1.06it/s, lr=2.36e-04, grad_norm=1.46e+05, amp=0]Epoch 0:  60%|██████    | 60/100 [00:56<00:37,  1.06it/s, lr=2.71e-04, grad_norm=1.50e+05, amp=0]Epoch 0:  70%|███████   | 70/100 [01:05<00:27,  1.07it/s, lr=2.71e-04, grad_norm=1.50e+05, amp=0]Epoch 0:  70%|███████   | 70/100 [01:05<00:27,  1.07it/s, lr=2.99e-04, grad_norm=1.45e+05, amp=0]Epoch 0:  80%|████████  | 80/100 [01:14<00:18,  1.08it/s, lr=2.99e-04, grad_norm=1.45e+05, amp=0]Epoch 0:  80%|████████  | 80/100 [01:14<00:18,  1.08it/s, lr=3.00e-04, grad_norm=1.50e+05, amp=0]Epoch 0:  90%|█████████ | 90/100 [01:22<00:09,  1.09it/s, lr=3.00e-04, grad_norm=1.50e+05, amp=0]Epoch 0:  90%|█████████ | 90/100 [01:22<00:09,  1.09it/s, lr=2.99e-04, grad_norm=1.60e+05, amp=0]Epoch 0: 100%|██████████| 100/100 [01:32<00:00,  1.08it/s, lr=2.99e-04, grad_norm=1.60e+05, amp=0]Epoch 0: 100%|██████████| 100/100 [01:32<00:00,  1.08it/s, lr=2.97e-04, grad_norm=1.66e+05, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:04<00:04,  2.11it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:09<00:00,  2.17it/s][A
                                                                        [AEpoch 0: 100%|██████████| 100/100 [01:41<00:00,  0.98it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.97e-04, grad_norm=1.66e+05, amp=0]Epoch 0: 100%|██████████| 100/100 [01:41<00:00,  0.98it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.97e-04, grad_norm=1.66e+05, amp=0]Epoch 0:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.97e-04, grad_norm=1.66e+05, amp=0]          Epoch 1:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.97e-04, grad_norm=1.66e+05, amp=0]Epoch 1:  10%|█         | 10/100 [00:09<01:24,  1.06it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.97e-04, grad_norm=1.66e+05, amp=0]Epoch 1:  10%|█         | 10/100 [00:09<01:24,  1.06it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.94e-04, grad_norm=1.72e+05, amp=0]Epoch 1:  20%|██        | 20/100 [00:19<01:18,  1.01it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.94e-04, grad_norm=1.72e+05, amp=0]Epoch 1:  20%|██        | 20/100 [00:19<01:18,  1.01it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.92e-04, grad_norm=1.79e+05, amp=0]Epoch 1:  30%|███       | 30/100 [00:28<01:05,  1.06it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.92e-04, grad_norm=1.79e+05, amp=0]Epoch 1:  30%|███       | 30/100 [00:28<01:05,  1.06it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.87e-04, grad_norm=2.01e+05, amp=0]Epoch 1:  40%|████      | 40/100 [00:37<00:55,  1.07it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.87e-04, grad_norm=2.01e+05, amp=0]Epoch 1:  40%|████      | 40/100 [00:37<00:55,  1.07it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.83e-04, grad_norm=2.14e+05, amp=0]Epoch 1:  50%|█████     | 50/100 [00:45<00:45,  1.09it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.83e-04, grad_norm=2.14e+05, amp=0]Epoch 1:  50%|█████     | 50/100 [00:45<00:45,  1.09it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.76e-04, grad_norm=2.39e+05, amp=0]Epoch 1:  60%|██████    | 60/100 [00:56<00:37,  1.06it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.76e-04, grad_norm=2.39e+05, amp=0]Epoch 1:  60%|██████    | 60/100 [00:56<00:37,  1.06it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.71e-04, grad_norm=2.72e+05, amp=0]Epoch 1:  70%|███████   | 70/100 [01:05<00:28,  1.07it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.71e-04, grad_norm=2.72e+05, amp=0]Epoch 1:  70%|███████   | 70/100 [01:05<00:28,  1.07it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.63e-04, grad_norm=3.12e+05, amp=0]Epoch 1:  80%|████████  | 80/100 [01:14<00:18,  1.07it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.63e-04, grad_norm=3.12e+05, amp=0]Epoch 1:  80%|████████  | 80/100 [01:14<00:18,  1.07it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.57e-04, grad_norm=3.52e+05, amp=0]Epoch 1:  90%|█████████ | 90/100 [01:24<00:09,  1.06it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.57e-04, grad_norm=3.52e+05, amp=0]Epoch 1:  90%|█████████ | 90/100 [01:24<00:09,  1.06it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.47e-04, grad_norm=4.06e+05, amp=0]Epoch 1: 100%|██████████| 100/100 [01:33<00:00,  1.07it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.47e-04, grad_norm=4.06e+05, amp=0]Epoch 1: 100%|██████████| 100/100 [01:33<00:00,  1.07it/s, val_loss_ep=3424.3635, val_loss=3438.5664, val_corr_ep=-0.010, val_corr=-0.021, lr=2.40e-04, grad_norm=4.70e+05, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:04<00:04,  2.27it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:08<00:00,  2.29it/s][A
                                                                        [AEpoch 1: 100%|██████████| 100/100 [01:42<00:00,  0.97it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.40e-04, grad_norm=4.70e+05, amp=0]Epoch 1: 100%|██████████| 100/100 [01:42<00:00,  0.97it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.40e-04, grad_norm=4.70e+05, amp=0]Epoch 1:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.40e-04, grad_norm=4.70e+05, amp=0]          Epoch 2:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.40e-04, grad_norm=4.70e+05, amp=0]Epoch 2:  10%|█         | 10/100 [00:10<01:38,  0.91it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.40e-04, grad_norm=4.70e+05, amp=0]Epoch 2:  10%|█         | 10/100 [00:10<01:38,  0.91it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.30e-04, grad_norm=5.47e+05, amp=0]Epoch 2:  20%|██        | 20/100 [00:20<01:21,  0.99it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.30e-04, grad_norm=5.47e+05, amp=0]Epoch 2:  20%|██        | 20/100 [00:20<01:21,  0.99it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.22e-04, grad_norm=6.02e+05, amp=0]Epoch 2:  30%|███       | 30/100 [00:28<01:07,  1.04it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.22e-04, grad_norm=6.02e+05, amp=0]Epoch 2:  30%|███       | 30/100 [00:28<01:07,  1.04it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.10e-04, grad_norm=7.02e+05, amp=0]Epoch 2:  40%|████      | 40/100 [00:38<00:57,  1.05it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.10e-04, grad_norm=7.02e+05, amp=0]Epoch 2:  40%|████      | 40/100 [00:38<00:57,  1.05it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.02e-04, grad_norm=7.47e+05, amp=0]Epoch 2:  50%|█████     | 50/100 [00:49<00:49,  1.02it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=2.02e-04, grad_norm=7.47e+05, amp=0]Epoch 2:  50%|█████     | 50/100 [00:49<00:49,  1.02it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.89e-04, grad_norm=8.36e+05, amp=0]Epoch 2:  60%|██████    | 60/100 [00:57<00:38,  1.04it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.89e-04, grad_norm=8.36e+05, amp=0]Epoch 2:  60%|██████    | 60/100 [00:57<00:38,  1.04it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.80e-04, grad_norm=8.80e+05, amp=0]Epoch 2:  70%|███████   | 70/100 [01:06<00:28,  1.05it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.80e-04, grad_norm=8.80e+05, amp=0]Epoch 2:  70%|███████   | 70/100 [01:06<00:28,  1.05it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.67e-04, grad_norm=9.93e+05, amp=0]Epoch 2:  80%|████████  | 80/100 [01:17<00:19,  1.04it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.67e-04, grad_norm=9.93e+05, amp=0]Epoch 2:  80%|████████  | 80/100 [01:17<00:19,  1.04it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.58e-04, grad_norm=1.00e+03, amp=0]Epoch 2:  90%|█████████ | 90/100 [01:26<00:09,  1.05it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.58e-04, grad_norm=1.00e+03, amp=0]Epoch 2:  90%|█████████ | 90/100 [01:26<00:09,  1.05it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.45e-04, grad_norm=1.00e+03, amp=0]Epoch 2: 100%|██████████| 100/100 [01:34<00:00,  1.06it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.45e-04, grad_norm=1.00e+03, amp=0]Epoch 2: 100%|██████████| 100/100 [01:34<00:00,  1.06it/s, val_loss_ep=3404.4370, val_loss=3418.5911, val_corr_ep=-0.024, val_corr=-0.030, lr=1.36e-04, grad_norm=1.00e+03, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:04<00:04,  2.41it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:08<00:00,  2.47it/s][A
                                                                        [AEpoch 2: 100%|██████████| 100/100 [01:42<00:00,  0.97it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.36e-04, grad_norm=1.00e+03, amp=0]Epoch 2: 100%|██████████| 100/100 [01:42<00:00,  0.97it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.36e-04, grad_norm=1.00e+03, amp=0]⚠️ AMPスケールが大幅に減少: 65536.0 → 1024.0
Epoch 2:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.36e-04, grad_norm=1.00e+03, amp=0]          Epoch 3:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.36e-04, grad_norm=1.00e+03, amp=0]Epoch 3:  10%|█         | 10/100 [00:11<01:41,  0.88it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.36e-04, grad_norm=1.00e+03, amp=0]Epoch 3:  10%|█         | 10/100 [00:11<01:41,  0.88it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.23e-04, grad_norm=1.67e+04, amp=0]Epoch 3:  20%|██        | 20/100 [00:19<01:18,  1.02it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.23e-04, grad_norm=1.67e+04, amp=0]Epoch 3:  20%|██        | 20/100 [00:19<01:18,  1.02it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.14e-04, grad_norm=1.76e+04, amp=0]Epoch 3:  30%|███       | 30/100 [00:27<01:05,  1.07it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.14e-04, grad_norm=1.76e+04, amp=0]Epoch 3:  30%|███       | 30/100 [00:27<01:05,  1.07it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.02e-04, grad_norm=1.94e+04, amp=0]Epoch 3:  40%|████      | 40/100 [00:36<00:55,  1.09it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=1.02e-04, grad_norm=1.94e+04, amp=0]Epoch 3:  40%|████      | 40/100 [00:36<00:55,  1.09it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=9.34e-05, grad_norm=2.06e+04, amp=0]Epoch 3:  50%|█████     | 50/100 [00:47<00:47,  1.06it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=9.34e-05, grad_norm=2.06e+04, amp=0]Epoch 3:  50%|█████     | 50/100 [00:47<00:47,  1.06it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=8.14e-05, grad_norm=2.22e+04, amp=0]Epoch 3:  60%|██████    | 60/100 [00:55<00:36,  1.09it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=8.14e-05, grad_norm=2.22e+04, amp=0]Epoch 3:  60%|██████    | 60/100 [00:55<00:36,  1.09it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=7.36e-05, grad_norm=2.32e+04, amp=0]Epoch 3:  70%|███████   | 70/100 [01:03<00:27,  1.10it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=7.36e-05, grad_norm=2.32e+04, amp=0]Epoch 3:  70%|███████   | 70/100 [01:03<00:27,  1.10it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=6.25e-05, grad_norm=2.43e+04, amp=0]Epoch 3:  80%|████████  | 80/100 [01:13<00:18,  1.09it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=6.25e-05, grad_norm=2.43e+04, amp=0]Epoch 3:  80%|████████  | 80/100 [01:13<00:18,  1.09it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=5.55e-05, grad_norm=2.51e+04, amp=0]Epoch 3:  90%|█████████ | 90/100 [01:21<00:09,  1.10it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=5.55e-05, grad_norm=2.51e+04, amp=0]Epoch 3:  90%|█████████ | 90/100 [01:21<00:09,  1.10it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=4.56e-05, grad_norm=2.58e+04, amp=0]Epoch 3: 100%|██████████| 100/100 [01:29<00:00,  1.11it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=4.56e-05, grad_norm=2.58e+04, amp=0]Epoch 3: 100%|██████████| 100/100 [01:29<00:00,  1.11it/s, val_loss_ep=3370.5193, val_loss=3384.6045, val_corr_ep=-0.034, val_corr=-0.052, lr=3.94e-05, grad_norm=2.61e+04, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:04<00:04,  2.15it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:08<00:00,  2.29it/s][A
                                                                        [AEpoch 3: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s, val_loss_ep=3319.3474, val_loss=3333.3623, val_corr_ep=-0.017, val_corr=-0.052, lr=3.94e-05, grad_norm=2.61e+04, amp=0]Epoch 3: 100%|██████████| 100/100 [01:39<00:00,  1.01it/s, val_loss_ep=3319.3474, val_loss=3333.3623, val_corr_ep=-0.017, val_corr=-0.052, lr=3.94e-05, grad_norm=2.61e+04, amp=0]Epoch 3: 100%|██████████| 100/100 [01:41<00:00,  0.98it/s, val_loss_ep=3319.3474, val_loss=3333.3623, val_corr_ep=-0.017, val_corr=-0.052, lr=3.94e-05, grad_norm=2.61e+04, amp=0]Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.model_summary.ModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

✅ 訓練完了
   最良チェックポイント: /mnt/c/Users/taki/Desktop/my-projects/GoriProject/stage1/checkpoints/stage1-epoch=00-val_correlation_mean=-0.0102.ckpt
   最良スコア: -0.010228987783193588
📈 最終評価実行中...
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/20 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s]Testing DataLoader 0:  50%|█████     | 10/20 [00:05<00:05,  1.91it/s]Testing DataLoader 0: 100%|██████████| 20/20 [00:08<00:00,  2.31it/s]Testing DataLoader 0: 100%|██████████| 20/20 [00:08<00:00,  2.30it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_amp_phase         1.9650464057922363
       val_corr_h1          0.04385681077837944
       val_corr_h4                  0.0
       val_corr_m1        -0.0010102748638018966
      val_corr_m15          -0.0214385986328125
      val_corr_m30          0.0265655517578125
       val_corr_m5         -0.054293058812618256
     val_correlation      -0.0010532577289268374
  val_correlation_mean    -0.0010532577289268374
        val_cross               21535.3125
        val_loss             3319.34619140625
      val_recon_tf          148.25289916992188
       val_spec_tf                  0.0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
