[rank: 0] Seed set to 42
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loading `train_dataloader` to estimate number of stepping batches.
🚀 Stage 1 訓練開始
   設定ファイル: configs/t5_baseline.yaml
   データディレクトリ: ../data/derived
   デバイス数: 1
📊 データローダー作成中...
🔄 Stage 1 Dataset初期化 (train)
   データディレクトリ: ../data/derived
   時間足: ['m1', 'm5', 'm15', 'm30', 'h1', 'h4']
   シーケンス長: 128
   M1: 3,104,383レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:24:00+00:00
   M5: 630,474レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:20:00+00:00
   M15: 210,477レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:15:00+00:00
   M30: 105,252レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H1: 52,632レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H4: 13,601レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 20:00:00+00:00
🔧 FeatureEngineer初期化
   特徴量数: 6
   特徴量: ['open', 'high', 'low', 'close', 'delta_close', 'body_ratio']
📏 TFNormalizer初期化
   統計ファイル: ../data/derived/stats.json
   キャッシュ有効: True
📂 正規化統計ロード完了: 2個のTF
🔄 MultiTFWindowSampler初期化 (train)
   📂 キャッシュからウィンドウ読み込み: windows_d4ec0e80.npy
   ⚡ ウィンドウ処理時間: 51.55秒
   総ウィンドウ数: 3104256
   trainウィンドウ数: 2483405
🎭 MaskingStrategy初期化
   マスク率: 0.15
   スパン範囲: 3-10
   TF間同期: True
🔄 Stage 1 Dataset初期化 (val)
   データディレクトリ: ../data/derived
   時間足: ['m1', 'm5', 'm15', 'm30', 'h1', 'h4']
   シーケンス長: 128
   M1: 3,104,383レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:24:00+00:00
   M5: 630,474レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:20:00+00:00
   M15: 210,477レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:15:00+00:00
   M30: 105,252レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H1: 52,632レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 23:00:00+00:00
   H4: 13,601レコード, 期間: 2017-01-03 08:00:00+00:00 - 2025-06-17 20:00:00+00:00
🔧 FeatureEngineer初期化
   特徴量数: 6
   特徴量: ['open', 'high', 'low', 'close', 'delta_close', 'body_ratio']
📏 TFNormalizer初期化
   統計ファイル: ../data/derived/stats.json
   キャッシュ有効: True
📂 正規化統計ロード完了: 2個のTF
🔄 MultiTFWindowSampler初期化 (val)
   📂 キャッシュからウィンドウ読み込み: windows_d4ec0e80.npy
   ⚡ ウィンドウ処理時間: 46.36秒
   総ウィンドウ数: 3104256
   valウィンドウ数: 620851
🎭 MaskingStrategy初期化
   マスク率: 0.15
   スパン範囲: 3-10
   TF間同期: True
📊 DataLoader作成完了
   訓練: 38803バッチ (2483405サンプル)
   検証: 9700バッチ (620851サンプル)
   最適化: num_workers=4, prefetch=2
🧠 モデル初期化中...
📦 従来のSharedEncoderを使用します
🎯 Stage1CombinedLoss初期化
   損失重み: {'recon_tf': 0.6, 'spec_tf': 0.2, 'cross': 0.15, 'amp_phase': 0.05}
⚡ Stage1LightningModule初期化完了
   モデル情報: {'total_parameters': 510824, 'trainable_parameters': 510824, 'model_size_mb': 1.948638916015625, 'architecture': {'n_tf': 6, 'seq_len': 128, 'n_features': 6, 'd_model': 64, 'latent_len': 'dynamic(32)'}}

  | Name      | Type               | Params | Mode 
---------------------------------------------------------
0 | model     | Stage1Model        | 510 K  | train
1 | criterion | Stage1CombinedLoss | 0      | train
---------------------------------------------------------
510 K     Trainable params
0         Non-trainable params
510 K     Total params
2.043     Total estimated model params size (MB)
141       Modules in train mode
0         Modules in eval mode
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:07<00:00,  0.28it/s]                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/100 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/100 [00:00<?, ?it/s] Epoch 0:  10%|█         | 10/100 [00:34<05:07,  0.29it/s]Epoch 0:  10%|█         | 10/100 [00:34<05:07,  0.29it/s, lr=3.12e-04, grad_norm=2.90e+05, amp=0]Epoch 0:  20%|██        | 20/100 [00:58<03:54,  0.34it/s, lr=3.12e-04, grad_norm=2.90e+05, amp=0]Epoch 0:  20%|██        | 20/100 [00:58<03:54,  0.34it/s, lr=3.57e-04, grad_norm=2.84e+05, amp=0]Epoch 0:  30%|███       | 30/100 [01:23<03:15,  0.36it/s, lr=3.57e-04, grad_norm=2.84e+05, amp=0]Epoch 0:  30%|███       | 30/100 [01:23<03:15,  0.36it/s, lr=4.32e-04, grad_norm=3.23e+05, amp=0]Epoch 0:  40%|████      | 40/100 [01:45<02:37,  0.38it/s, lr=4.32e-04, grad_norm=3.23e+05, amp=0]Epoch 0:  40%|████      | 40/100 [01:45<02:37,  0.38it/s, lr=5.29e-04, grad_norm=4.11e+05, amp=0]Epoch 0:  50%|█████     | 50/100 [02:07<02:07,  0.39it/s, lr=5.29e-04, grad_norm=4.11e+05, amp=0]Epoch 0:  50%|█████     | 50/100 [02:07<02:07,  0.39it/s, lr=6.39e-04, grad_norm=7.12e+05, amp=0]Epoch 0:  60%|██████    | 60/100 [02:34<01:43,  0.39it/s, lr=6.39e-04, grad_norm=7.12e+05, amp=0]Epoch 0:  60%|██████    | 60/100 [02:34<01:43,  0.39it/s, lr=7.50e-04, grad_norm=6.65e+05, amp=0]Epoch 0:  70%|███████   | 70/100 [02:57<01:15,  0.39it/s, lr=7.50e-04, grad_norm=6.65e+05, amp=0]Epoch 0:  70%|███████   | 70/100 [02:57<01:15,  0.39it/s, lr=8.50e-04, grad_norm=6.72e+05, amp=0]Epoch 0:  80%|████████  | 80/100 [03:25<00:51,  0.39it/s, lr=8.50e-04, grad_norm=6.72e+05, amp=0]Epoch 0:  80%|████████  | 80/100 [03:25<00:51,  0.39it/s, lr=9.31e-04, grad_norm=7.00e+05, amp=0]Epoch 0:  90%|█████████ | 90/100 [03:42<00:24,  0.40it/s, lr=9.31e-04, grad_norm=7.00e+05, amp=0]Epoch 0:  90%|█████████ | 90/100 [03:42<00:24,  0.40it/s, lr=9.82e-04, grad_norm=6.71e+05, amp=0]Epoch 0: 100%|██████████| 100/100 [03:53<00:00,  0.43it/s, lr=9.82e-04, grad_norm=6.71e+05, amp=0]Epoch 0: 100%|██████████| 100/100 [03:53<00:00,  0.43it/s, lr=1.00e-03, grad_norm=5.69e+05, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  2.86it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:07<00:00,  2.75it/s][A
                                                                        [AEpoch 0: 100%|██████████| 100/100 [04:00<00:00,  0.42it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=1.00e-03, grad_norm=5.69e+05, amp=0]Epoch 0: 100%|██████████| 100/100 [04:00<00:00,  0.42it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=1.00e-03, grad_norm=5.69e+05, amp=0]⚠️ AMPスケールが大幅に減少: 65536.0 → 2048.0
Epoch 0:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=1.00e-03, grad_norm=5.69e+05, amp=0]          Epoch 1:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=1.00e-03, grad_norm=5.69e+05, amp=0]Epoch 1:  10%|█         | 10/100 [00:11<01:44,  0.86it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=1.00e-03, grad_norm=5.69e+05, amp=0]Epoch 1:  10%|█         | 10/100 [00:11<01:44,  0.86it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=1.00e-03, grad_norm=7.19e+05, amp=0]Epoch 1:  20%|██        | 20/100 [00:22<01:30,  0.89it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=1.00e-03, grad_norm=7.19e+05, amp=0]Epoch 1:  20%|██        | 20/100 [00:22<01:30,  0.88it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=1.00e-03, grad_norm=3.32e+05, amp=0]Epoch 1:  30%|███       | 30/100 [00:33<01:18,  0.89it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=1.00e-03, grad_norm=3.32e+05, amp=0]Epoch 1:  30%|███       | 30/100 [00:33<01:18,  0.89it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.99e-04, grad_norm=1.41e+05, amp=0]Epoch 1:  40%|████      | 40/100 [00:44<01:06,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.99e-04, grad_norm=1.41e+05, amp=0]Epoch 1:  40%|████      | 40/100 [00:44<01:06,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.99e-04, grad_norm=2.84e+05, amp=0]Epoch 1:  50%|█████     | 50/100 [00:55<00:55,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.99e-04, grad_norm=2.84e+05, amp=0]Epoch 1:  50%|█████     | 50/100 [00:55<00:55,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.98e-04, grad_norm=6.44e+04, amp=0]Epoch 1:  60%|██████    | 60/100 [01:06<00:44,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.98e-04, grad_norm=6.44e+04, amp=0]Epoch 1:  60%|██████    | 60/100 [01:06<00:44,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.98e-04, grad_norm=7.17e+04, amp=0]Epoch 1:  70%|███████   | 70/100 [01:17<00:33,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.98e-04, grad_norm=7.17e+04, amp=0]Epoch 1:  70%|███████   | 70/100 [01:17<00:33,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.97e-04, grad_norm=4.69e+04, amp=0]Epoch 1:  80%|████████  | 80/100 [01:28<00:22,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.97e-04, grad_norm=4.69e+04, amp=0]Epoch 1:  80%|████████  | 80/100 [01:28<00:22,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.96e-04, grad_norm=6.05e+04, amp=0]Epoch 1:  90%|█████████ | 90/100 [01:39<00:11,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.96e-04, grad_norm=6.05e+04, amp=0]Epoch 1:  90%|█████████ | 90/100 [01:39<00:11,  0.90it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.95e-04, grad_norm=6.11e+04, amp=0]Epoch 1: 100%|██████████| 100/100 [01:50<00:00,  0.91it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.95e-04, grad_norm=6.11e+04, amp=0]Epoch 1: 100%|██████████| 100/100 [01:50<00:00,  0.91it/s, val_loss_ep=2256.5264, val_loss=2274.8975, val_corr_ep=-0.098, val_corr=+0.033, lr=9.93e-04, grad_norm=3.81e+04, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  2.82it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:07<00:00,  2.84it/s][A
                                                                        [AEpoch 1: 100%|██████████| 100/100 [01:57<00:00,  0.85it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.93e-04, grad_norm=3.81e+04, amp=0]  Epoch 1: 100%|██████████| 100/100 [01:57<00:00,  0.85it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.93e-04, grad_norm=3.81e+04, amp=0]Epoch 1:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.93e-04, grad_norm=3.81e+04, amp=0]          Epoch 2:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.93e-04, grad_norm=3.81e+04, amp=0]Epoch 2:  10%|█         | 10/100 [00:11<01:44,  0.86it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.93e-04, grad_norm=3.81e+04, amp=0]Epoch 2:  10%|█         | 10/100 [00:11<01:44,  0.86it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.92e-04, grad_norm=3.77e+04, amp=0]Epoch 2:  20%|██        | 20/100 [00:22<01:28,  0.90it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.92e-04, grad_norm=3.77e+04, amp=0]Epoch 2:  20%|██        | 20/100 [00:22<01:28,  0.90it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.90e-04, grad_norm=1.94e+04, amp=0]Epoch 2:  30%|███       | 30/100 [00:33<01:17,  0.90it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.90e-04, grad_norm=1.94e+04, amp=0]Epoch 2:  30%|███       | 30/100 [00:33<01:17,  0.90it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.89e-04, grad_norm=2.49e+04, amp=0]Epoch 2:  40%|████      | 40/100 [00:44<01:06,  0.90it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.89e-04, grad_norm=2.49e+04, amp=0]Epoch 2:  40%|████      | 40/100 [00:44<01:06,  0.90it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.87e-04, grad_norm=2.50e+04, amp=0]Epoch 2:  50%|█████     | 50/100 [00:55<00:55,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.87e-04, grad_norm=2.50e+04, amp=0]Epoch 2:  50%|█████     | 50/100 [00:55<00:55,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.85e-04, grad_norm=3.30e+04, amp=0]Epoch 2:  60%|██████    | 60/100 [01:06<00:44,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.85e-04, grad_norm=3.30e+04, amp=0]Epoch 2:  60%|██████    | 60/100 [01:06<00:44,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.83e-04, grad_norm=3.90e+04, amp=0]Epoch 2:  70%|███████   | 70/100 [01:16<00:32,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.83e-04, grad_norm=3.90e+04, amp=0]Epoch 2:  70%|███████   | 70/100 [01:16<00:32,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.80e-04, grad_norm=1.99e+04, amp=0]Epoch 2:  80%|████████  | 80/100 [01:27<00:21,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.80e-04, grad_norm=1.99e+04, amp=0]Epoch 2:  80%|████████  | 80/100 [01:27<00:21,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.78e-04, grad_norm=2.40e+04, amp=0]Epoch 2:  90%|█████████ | 90/100 [01:38<00:10,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.78e-04, grad_norm=2.40e+04, amp=0]Epoch 2:  90%|█████████ | 90/100 [01:38<00:10,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.76e-04, grad_norm=3.90e+04, amp=0]Epoch 2: 100%|██████████| 100/100 [01:49<00:00,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.76e-04, grad_norm=3.90e+04, amp=0]Epoch 2: 100%|██████████| 100/100 [01:49<00:00,  0.91it/s, val_loss_ep=202.6563, val_loss=207.4938, val_corr_ep=-0.088, val_corr=+0.038, lr=9.73e-04, grad_norm=4.08e+04, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  2.95it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:06<00:00,  2.88it/s][A
                                                                        [AEpoch 2: 100%|██████████| 100/100 [01:57<00:00,  0.85it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.73e-04, grad_norm=4.08e+04, amp=0]Epoch 2: 100%|██████████| 100/100 [01:57<00:00,  0.85it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.73e-04, grad_norm=4.08e+04, amp=0]Epoch 2:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.73e-04, grad_norm=4.08e+04, amp=0]          Epoch 3:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.73e-04, grad_norm=4.08e+04, amp=0]Epoch 3:  10%|█         | 10/100 [00:11<01:44,  0.86it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.73e-04, grad_norm=4.08e+04, amp=0]Epoch 3:  10%|█         | 10/100 [00:11<01:44,  0.86it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.70e-04, grad_norm=5.37e+04, amp=0]Epoch 3:  20%|██        | 20/100 [00:22<01:29,  0.90it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.70e-04, grad_norm=5.37e+04, amp=0]Epoch 3:  20%|██        | 20/100 [00:22<01:29,  0.90it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.67e-04, grad_norm=2.81e+04, amp=0]Epoch 3:  30%|███       | 30/100 [00:33<01:17,  0.90it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.67e-04, grad_norm=2.81e+04, amp=0]Epoch 3:  30%|███       | 30/100 [00:33<01:17,  0.90it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.64e-04, grad_norm=6.63e+04, amp=0]Epoch 3:  40%|████      | 40/100 [00:44<01:06,  0.90it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.64e-04, grad_norm=6.63e+04, amp=0]Epoch 3:  40%|████      | 40/100 [00:44<01:06,  0.90it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.61e-04, grad_norm=9.89e+04, amp=0]Epoch 3:  50%|█████     | 50/100 [00:55<00:55,  0.90it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.61e-04, grad_norm=9.89e+04, amp=0]Epoch 3:  50%|█████     | 50/100 [00:55<00:55,  0.90it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.58e-04, grad_norm=6.74e+04, amp=0]Epoch 3:  60%|██████    | 60/100 [01:06<00:44,  0.91it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.58e-04, grad_norm=6.74e+04, amp=0]Epoch 3:  60%|██████    | 60/100 [01:06<00:44,  0.91it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.55e-04, grad_norm=5.44e+04, amp=0]Epoch 3:  70%|███████   | 70/100 [01:17<00:33,  0.91it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.55e-04, grad_norm=5.44e+04, amp=0]Epoch 3:  70%|███████   | 70/100 [01:17<00:33,  0.91it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.51e-04, grad_norm=2.68e+04, amp=0]Epoch 3:  80%|████████  | 80/100 [01:28<00:22,  0.91it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.51e-04, grad_norm=2.68e+04, amp=0]Epoch 3:  80%|████████  | 80/100 [01:28<00:22,  0.91it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.48e-04, grad_norm=2.70e+04, amp=0]Epoch 3:  90%|█████████ | 90/100 [01:50<00:12,  0.82it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.48e-04, grad_norm=2.70e+04, amp=0]Epoch 3:  90%|█████████ | 90/100 [01:50<00:12,  0.82it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.44e-04, grad_norm=5.77e+04, amp=0]Epoch 3: 100%|██████████| 100/100 [02:01<00:00,  0.82it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.44e-04, grad_norm=5.77e+04, amp=0]Epoch 3: 100%|██████████| 100/100 [02:01<00:00,  0.82it/s, val_loss_ep=253.5608, val_loss=259.2244, val_corr_ep=-0.091, val_corr=+0.069, lr=9.40e-04, grad_norm=2.97e+04, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  3.03it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:06<00:00,  3.05it/s][A
                                                                        [AEpoch 3: 100%|██████████| 100/100 [02:08<00:00,  0.78it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.40e-04, grad_norm=2.97e+04, amp=0]Epoch 3: 100%|██████████| 100/100 [02:08<00:00,  0.78it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.40e-04, grad_norm=2.97e+04, amp=0]Epoch 3:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.40e-04, grad_norm=2.97e+04, amp=0]          Epoch 4:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.40e-04, grad_norm=2.97e+04, amp=0]Epoch 4:  10%|█         | 10/100 [00:11<01:45,  0.85it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.40e-04, grad_norm=2.97e+04, amp=0]Epoch 4:  10%|█         | 10/100 [00:11<01:45,  0.85it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.36e-04, grad_norm=3.11e+04, amp=0]Epoch 4:  20%|██        | 20/100 [00:23<01:32,  0.87it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.36e-04, grad_norm=3.11e+04, amp=0]Epoch 4:  20%|██        | 20/100 [00:23<01:32,  0.87it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.32e-04, grad_norm=5.57e+04, amp=0]Epoch 4:  30%|███       | 30/100 [00:33<01:19,  0.88it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.32e-04, grad_norm=5.57e+04, amp=0]Epoch 4:  30%|███       | 30/100 [00:33<01:19,  0.88it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.28e-04, grad_norm=6.18e+04, amp=0]Epoch 4:  40%|████      | 40/100 [00:45<01:07,  0.88it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.28e-04, grad_norm=6.18e+04, amp=0]Epoch 4:  40%|████      | 40/100 [00:45<01:07,  0.88it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.24e-04, grad_norm=5.03e+04, amp=0]Epoch 4:  50%|█████     | 50/100 [00:56<00:56,  0.88it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.24e-04, grad_norm=5.03e+04, amp=0]Epoch 4:  50%|█████     | 50/100 [00:56<00:56,  0.88it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.19e-04, grad_norm=4.22e+04, amp=0]Epoch 4:  60%|██████    | 60/100 [01:07<00:45,  0.89it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.19e-04, grad_norm=4.22e+04, amp=0]Epoch 4:  60%|██████    | 60/100 [01:07<00:45,  0.89it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.15e-04, grad_norm=4.61e+04, amp=0]Epoch 4:  70%|███████   | 70/100 [01:18<00:33,  0.89it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.15e-04, grad_norm=4.61e+04, amp=0]Epoch 4:  70%|███████   | 70/100 [01:18<00:33,  0.89it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.10e-04, grad_norm=3.17e+04, amp=0]Epoch 4:  80%|████████  | 80/100 [01:29<00:22,  0.89it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.10e-04, grad_norm=3.17e+04, amp=0]Epoch 4:  80%|████████  | 80/100 [01:29<00:22,  0.89it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.05e-04, grad_norm=1.40e+05, amp=0]Epoch 4:  90%|█████████ | 90/100 [01:41<00:11,  0.89it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.05e-04, grad_norm=1.40e+05, amp=0]Epoch 4:  90%|█████████ | 90/100 [01:41<00:11,  0.89it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.00e-04, grad_norm=6.09e+04, amp=0]Epoch 4: 100%|██████████| 100/100 [01:52<00:00,  0.89it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=9.00e-04, grad_norm=6.09e+04, amp=0]Epoch 4: 100%|██████████| 100/100 [01:52<00:00,  0.89it/s, val_loss_ep=270.5661, val_loss=276.3818, val_corr_ep=-0.083, val_corr=+0.063, lr=8.95e-04, grad_norm=3.52e+04, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  2.90it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:06<00:00,  2.91it/s][A
                                                                        [AEpoch 4: 100%|██████████| 100/100 [01:59<00:00,  0.84it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.95e-04, grad_norm=3.52e+04, amp=0]Epoch 4: 100%|██████████| 100/100 [01:59<00:00,  0.84it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.95e-04, grad_norm=3.52e+04, amp=0]Epoch 4:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.95e-04, grad_norm=3.52e+04, amp=0]          Epoch 5:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.95e-04, grad_norm=3.52e+04, amp=0]Epoch 5:  10%|█         | 10/100 [00:11<01:43,  0.87it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.95e-04, grad_norm=3.52e+04, amp=0]Epoch 5:  10%|█         | 10/100 [00:11<01:43,  0.87it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.90e-04, grad_norm=1.00e+03, amp=0]Epoch 5:  20%|██        | 20/100 [00:23<01:32,  0.87it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.90e-04, grad_norm=1.00e+03, amp=0]Epoch 5:  20%|██        | 20/100 [00:23<01:32,  0.87it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.85e-04, grad_norm=4.97e+04, amp=0]Epoch 5:  30%|███       | 30/100 [00:34<01:19,  0.88it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.85e-04, grad_norm=4.97e+04, amp=0]Epoch 5:  30%|███       | 30/100 [00:34<01:19,  0.88it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.80e-04, grad_norm=8.63e+04, amp=0]Epoch 5:  40%|████      | 40/100 [00:45<01:07,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.80e-04, grad_norm=8.63e+04, amp=0]Epoch 5:  40%|████      | 40/100 [00:45<01:07,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.74e-04, grad_norm=1.10e+05, amp=0]Epoch 5:  50%|█████     | 50/100 [00:56<00:56,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.74e-04, grad_norm=1.10e+05, amp=0]Epoch 5:  50%|█████     | 50/100 [00:56<00:56,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.69e-04, grad_norm=9.78e+04, amp=0]Epoch 5:  60%|██████    | 60/100 [01:07<00:44,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.69e-04, grad_norm=9.78e+04, amp=0]Epoch 5:  60%|██████    | 60/100 [01:07<00:44,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.63e-04, grad_norm=4.59e+04, amp=0]Epoch 5:  70%|███████   | 70/100 [01:18<00:33,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.63e-04, grad_norm=4.59e+04, amp=0]Epoch 5:  70%|███████   | 70/100 [01:18<00:33,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.57e-04, grad_norm=3.41e+04, amp=0]Epoch 5:  80%|████████  | 80/100 [01:29<00:22,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.57e-04, grad_norm=3.41e+04, amp=0]Epoch 5:  80%|████████  | 80/100 [01:29<00:22,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.52e-04, grad_norm=4.49e+04, amp=0]Epoch 5:  90%|█████████ | 90/100 [01:40<00:11,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.52e-04, grad_norm=4.49e+04, amp=0]Epoch 5:  90%|█████████ | 90/100 [01:40<00:11,  0.89it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.46e-04, grad_norm=7.19e+04, amp=0]Epoch 5: 100%|██████████| 100/100 [01:51<00:00,  0.90it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.46e-04, grad_norm=7.19e+04, amp=0]Epoch 5: 100%|██████████| 100/100 [01:51<00:00,  0.90it/s, val_loss_ep=168.7123, val_loss=162.0235, val_corr_ep=-0.081, val_corr=+0.054, lr=8.40e-04, grad_norm=4.62e+04, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  2.75it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:07<00:00,  2.67it/s][A
                                                                        [AEpoch 5: 100%|██████████| 100/100 [01:59<00:00,  0.84it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.40e-04, grad_norm=4.62e+04, amp=0]  Epoch 5: 100%|██████████| 100/100 [01:59<00:00,  0.84it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.40e-04, grad_norm=4.62e+04, amp=0]⚠️ AMPスケールが大幅に減少: 1024.0 → 256.0
Epoch 5:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.40e-04, grad_norm=4.62e+04, amp=0]          Epoch 6:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.40e-04, grad_norm=4.62e+04, amp=0]Epoch 6:  10%|█         | 10/100 [00:11<01:44,  0.86it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.40e-04, grad_norm=4.62e+04, amp=0]Epoch 6:  10%|█         | 10/100 [00:11<01:44,  0.86it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.34e-04, grad_norm=2.22e+04, amp=0]Epoch 6:  20%|██        | 20/100 [00:22<01:30,  0.88it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.34e-04, grad_norm=2.22e+04, amp=0]Epoch 6:  20%|██        | 20/100 [00:22<01:30,  0.88it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.27e-04, grad_norm=7.32e+04, amp=0]Epoch 6:  30%|███       | 30/100 [00:33<01:19,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.27e-04, grad_norm=7.32e+04, amp=0]Epoch 6:  30%|███       | 30/100 [00:33<01:19,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.21e-04, grad_norm=1.00e+03, amp=0]Epoch 6:  40%|████      | 40/100 [00:44<01:07,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.21e-04, grad_norm=1.00e+03, amp=0]Epoch 6:  40%|████      | 40/100 [00:44<01:07,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.15e-04, grad_norm=1.66e+04, amp=0]Epoch 6:  50%|█████     | 50/100 [00:55<00:55,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.15e-04, grad_norm=1.66e+04, amp=0]Epoch 6:  50%|█████     | 50/100 [00:55<00:55,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.08e-04, grad_norm=2.82e+04, amp=0]Epoch 6:  60%|██████    | 60/100 [01:07<00:44,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.08e-04, grad_norm=2.82e+04, amp=0]Epoch 6:  60%|██████    | 60/100 [01:07<00:44,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.02e-04, grad_norm=2.86e+04, amp=0]Epoch 6:  70%|███████   | 70/100 [01:18<00:33,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=8.02e-04, grad_norm=2.86e+04, amp=0]Epoch 6:  70%|███████   | 70/100 [01:18<00:33,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=7.95e-04, grad_norm=5.97e+04, amp=0]Epoch 6:  80%|████████  | 80/100 [01:29<00:22,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=7.95e-04, grad_norm=5.97e+04, amp=0]Epoch 6:  80%|████████  | 80/100 [01:29<00:22,  0.89it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=7.88e-04, grad_norm=4.25e+04, amp=0]Epoch 6:  90%|█████████ | 90/100 [01:40<00:11,  0.90it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=7.88e-04, grad_norm=4.25e+04, amp=0]Epoch 6:  90%|█████████ | 90/100 [01:40<00:11,  0.90it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=7.82e-04, grad_norm=3.67e+04, amp=0]Epoch 6: 100%|██████████| 100/100 [01:51<00:00,  0.90it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=7.82e-04, grad_norm=3.67e+04, amp=0]Epoch 6: 100%|██████████| 100/100 [01:51<00:00,  0.90it/s, val_loss_ep=83.5300, val_loss=84.5610, val_corr_ep=-0.089, val_corr=-0.045, lr=7.75e-04, grad_norm=3.33e+04, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  3.13it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:07<00:00,  2.81it/s][A
                                                                        [AEpoch 6: 100%|██████████| 100/100 [01:58<00:00,  0.84it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.75e-04, grad_norm=3.33e+04, amp=0]Epoch 6: 100%|██████████| 100/100 [01:58<00:00,  0.84it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.75e-04, grad_norm=3.33e+04, amp=0]Epoch 6:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.75e-04, grad_norm=3.33e+04, amp=0]          Epoch 7:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.75e-04, grad_norm=3.33e+04, amp=0]Epoch 7:  10%|█         | 10/100 [00:11<01:45,  0.86it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.75e-04, grad_norm=3.33e+04, amp=0]Epoch 7:  10%|█         | 10/100 [00:11<01:45,  0.86it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.68e-04, grad_norm=5.32e+03, amp=0]Epoch 7:  20%|██        | 20/100 [00:22<01:31,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.68e-04, grad_norm=5.32e+03, amp=0]Epoch 7:  20%|██        | 20/100 [00:22<01:31,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.61e-04, grad_norm=1.16e+04, amp=0]Epoch 7:  30%|███       | 30/100 [00:34<01:20,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.61e-04, grad_norm=1.16e+04, amp=0]Epoch 7:  30%|███       | 30/100 [00:34<01:20,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.54e-04, grad_norm=2.40e+04, amp=0]Epoch 7:  40%|████      | 40/100 [00:46<01:09,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.54e-04, grad_norm=2.40e+04, amp=0]Epoch 7:  40%|████      | 40/100 [00:46<01:09,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.47e-04, grad_norm=3.12e+04, amp=0]Epoch 7:  50%|█████     | 50/100 [00:57<00:57,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.47e-04, grad_norm=3.12e+04, amp=0]Epoch 7:  50%|█████     | 50/100 [00:57<00:57,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.40e-04, grad_norm=2.74e+04, amp=0]Epoch 7:  60%|██████    | 60/100 [01:09<00:46,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.40e-04, grad_norm=2.74e+04, amp=0]Epoch 7:  60%|██████    | 60/100 [01:09<00:46,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.32e-04, grad_norm=4.09e+04, amp=0]Epoch 7:  70%|███████   | 70/100 [01:20<00:34,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.32e-04, grad_norm=4.09e+04, amp=0]Epoch 7:  70%|███████   | 70/100 [01:20<00:34,  0.87it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.25e-04, grad_norm=1.57e+04, amp=0]Epoch 7:  80%|████████  | 80/100 [01:31<00:22,  0.88it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.25e-04, grad_norm=1.57e+04, amp=0]Epoch 7:  80%|████████  | 80/100 [01:31<00:22,  0.88it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.18e-04, grad_norm=2.30e+04, amp=0]Epoch 7:  90%|█████████ | 90/100 [01:42<00:11,  0.88it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.18e-04, grad_norm=2.30e+04, amp=0]Epoch 7:  90%|█████████ | 90/100 [01:42<00:11,  0.88it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.10e-04, grad_norm=8.91e+03, amp=0]Epoch 7: 100%|██████████| 100/100 [01:53<00:00,  0.88it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.10e-04, grad_norm=8.91e+03, amp=0]Epoch 7: 100%|██████████| 100/100 [01:53<00:00,  0.88it/s, val_loss_ep=101.9278, val_loss=89.0051, val_corr_ep=-0.060, val_corr=+0.022, lr=7.03e-04, grad_norm=2.42e+04, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  2.81it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:07<00:00,  2.79it/s][A
                                                                        [AEpoch 7: 100%|██████████| 100/100 [02:00<00:00,  0.83it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=7.03e-04, grad_norm=2.42e+04, amp=0] Epoch 7: 100%|██████████| 100/100 [02:00<00:00,  0.83it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=7.03e-04, grad_norm=2.42e+04, amp=0]Epoch 7:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=7.03e-04, grad_norm=2.42e+04, amp=0]          Epoch 8:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=7.03e-04, grad_norm=2.42e+04, amp=0]Epoch 8:  10%|█         | 10/100 [00:11<01:46,  0.85it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=7.03e-04, grad_norm=2.42e+04, amp=0]Epoch 8:  10%|█         | 10/100 [00:11<01:46,  0.85it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.95e-04, grad_norm=2.63e+04, amp=0]Epoch 8:  20%|██        | 20/100 [00:22<01:31,  0.87it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.95e-04, grad_norm=2.63e+04, amp=0]Epoch 8:  20%|██        | 20/100 [00:22<01:31,  0.87it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.87e-04, grad_norm=1.77e+04, amp=0]Epoch 8:  30%|███       | 30/100 [00:34<01:19,  0.88it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.87e-04, grad_norm=1.77e+04, amp=0]Epoch 8:  30%|███       | 30/100 [00:34<01:19,  0.88it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.80e-04, grad_norm=7.49e+03, amp=0]Epoch 8:  40%|████      | 40/100 [00:45<01:08,  0.88it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.80e-04, grad_norm=7.49e+03, amp=0]Epoch 8:  40%|████      | 40/100 [00:45<01:08,  0.88it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.72e-04, grad_norm=6.96e+03, amp=0]Epoch 8:  50%|█████     | 50/100 [00:56<00:56,  0.88it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.72e-04, grad_norm=6.96e+03, amp=0]Epoch 8:  50%|█████     | 50/100 [00:56<00:56,  0.88it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.64e-04, grad_norm=1.58e+04, amp=0]Epoch 8:  60%|██████    | 60/100 [01:07<00:45,  0.89it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.64e-04, grad_norm=1.58e+04, amp=0]Epoch 8:  60%|██████    | 60/100 [01:07<00:45,  0.89it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.57e-04, grad_norm=8.06e+03, amp=0]Epoch 8:  70%|███████   | 70/100 [01:18<00:33,  0.89it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.57e-04, grad_norm=8.06e+03, amp=0]Epoch 8:  70%|███████   | 70/100 [01:18<00:33,  0.89it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.49e-04, grad_norm=3.01e+04, amp=0]Epoch 8:  80%|████████  | 80/100 [01:29<00:22,  0.89it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.49e-04, grad_norm=3.01e+04, amp=0]Epoch 8:  80%|████████  | 80/100 [01:29<00:22,  0.89it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.41e-04, grad_norm=1.98e+04, amp=0]Epoch 8:  90%|█████████ | 90/100 [01:40<00:11,  0.89it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.41e-04, grad_norm=1.98e+04, amp=0]Epoch 8:  90%|█████████ | 90/100 [01:40<00:11,  0.89it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.33e-04, grad_norm=1.09e+04, amp=0]Epoch 8: 100%|██████████| 100/100 [01:52<00:00,  0.89it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.33e-04, grad_norm=1.09e+04, amp=0]Epoch 8: 100%|██████████| 100/100 [01:52<00:00,  0.89it/s, val_loss_ep=60.9806, val_loss=59.3948, val_corr_ep=-0.063, val_corr=+0.026, lr=6.25e-04, grad_norm=2.01e+04, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  2.67it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:07<00:00,  2.67it/s][A
                                                                        [AEpoch 8: 100%|██████████| 100/100 [02:00<00:00,  0.83it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.25e-04, grad_norm=2.01e+04, amp=0]Epoch 8: 100%|██████████| 100/100 [02:00<00:00,  0.83it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.25e-04, grad_norm=2.01e+04, amp=0]Epoch 8:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.25e-04, grad_norm=2.01e+04, amp=0]          Epoch 9:   0%|          | 0/100 [00:00<?, ?it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.25e-04, grad_norm=2.01e+04, amp=0]Epoch 9:  10%|█         | 10/100 [00:11<01:45,  0.85it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.25e-04, grad_norm=2.01e+04, amp=0]Epoch 9:  10%|█         | 10/100 [00:11<01:45,  0.85it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.17e-04, grad_norm=1.74e+04, amp=0]Epoch 9:  20%|██        | 20/100 [00:22<01:31,  0.87it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.17e-04, grad_norm=1.74e+04, amp=0]Epoch 9:  20%|██        | 20/100 [00:22<01:31,  0.87it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.09e-04, grad_norm=1.65e+04, amp=0]Epoch 9:  30%|███       | 30/100 [00:33<01:19,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.09e-04, grad_norm=1.65e+04, amp=0]Epoch 9:  30%|███       | 30/100 [00:33<01:19,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.01e-04, grad_norm=3.60e+04, amp=0]Epoch 9:  40%|████      | 40/100 [00:45<01:07,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=6.01e-04, grad_norm=3.60e+04, amp=0]Epoch 9:  40%|████      | 40/100 [00:45<01:07,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.93e-04, grad_norm=1.44e+04, amp=0]Epoch 9:  50%|█████     | 50/100 [00:56<00:56,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.93e-04, grad_norm=1.44e+04, amp=0]Epoch 9:  50%|█████     | 50/100 [00:56<00:56,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.85e-04, grad_norm=5.86e+03, amp=0]Epoch 9:  60%|██████    | 60/100 [01:07<00:44,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.85e-04, grad_norm=5.86e+03, amp=0]Epoch 9:  60%|██████    | 60/100 [01:07<00:44,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.77e-04, grad_norm=3.48e+04, amp=0]Epoch 9:  70%|███████   | 70/100 [01:18<00:33,  0.90it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.77e-04, grad_norm=3.48e+04, amp=0]Epoch 9:  70%|███████   | 70/100 [01:18<00:33,  0.90it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.69e-04, grad_norm=1.58e+04, amp=0]Epoch 9:  80%|████████  | 80/100 [01:29<00:22,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.69e-04, grad_norm=1.58e+04, amp=0]Epoch 9:  80%|████████  | 80/100 [01:29<00:22,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.60e-04, grad_norm=9.25e+03, amp=0]Epoch 9:  90%|█████████ | 90/100 [01:40<00:11,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.60e-04, grad_norm=9.25e+03, amp=0]Epoch 9:  90%|█████████ | 90/100 [01:40<00:11,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.52e-04, grad_norm=2.97e+04, amp=0]Epoch 9: 100%|██████████| 100/100 [01:51<00:00,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.52e-04, grad_norm=2.97e+04, amp=0]Epoch 9: 100%|██████████| 100/100 [01:51<00:00,  0.89it/s, val_loss_ep=58.8004, val_loss=57.1967, val_corr_ep=-0.074, val_corr=+0.002, lr=5.44e-04, grad_norm=4.18e+04, amp=0]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s][A
Validation DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  2.89it/s][A
Validation DataLoader 0: 100%|██████████| 20/20 [00:07<00:00,  2.76it/s][A
                                                                        [AEpoch 9: 100%|██████████| 100/100 [01:59<00:00,  0.84it/s, val_loss_ep=92.4833, val_loss=79.7520, val_corr_ep=-0.080, val_corr=-0.127, lr=5.44e-04, grad_norm=4.18e+04, amp=0]Epoch 9: 100%|██████████| 100/100 [01:59<00:00,  0.84it/s, val_loss_ep=92.4833, val_loss=79.7520, val_corr_ep=-0.080, val_corr=-0.127, lr=5.44e-04, grad_norm=4.18e+04, amp=0]Epoch 9: 100%|██████████| 100/100 [01:59<00:00,  0.84it/s, val_loss_ep=92.4833, val_loss=79.7520, val_corr_ep=-0.080, val_corr=-0.127, lr=5.44e-04, grad_norm=4.18e+04, amp=0]Using 16bit Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.model_summary.ModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

✅ 訓練完了
   最良チェックポイント: /mnt/c/Users/taki/Desktop/my-projects/GoriProject/stage1/checkpoints/stage1-epoch=06-val_correlation_mean=-0.0604.ckpt
   最良スコア: -0.060446105897426605
📈 最終評価実行中...
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/20 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/20 [00:00<?, ?it/s]Testing DataLoader 0:  50%|█████     | 10/20 [00:03<00:03,  3.06it/s]Testing DataLoader 0: 100%|██████████| 20/20 [00:06<00:00,  3.02it/s]Testing DataLoader 0: 100%|██████████| 20/20 [00:06<00:00,  3.00it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      val_amp_phase          1.967254638671875
       val_corr_h1         -0.30549317598342896
       val_corr_h4                  0.0
       val_corr_m1         -0.007193041034042835
      val_corr_m15         -0.05505180358886719
      val_corr_m30         -0.16794204711914062
       val_corr_m5         -0.007930755615234375
     val_correlation       -0.09060180187225342
  val_correlation_mean     -0.09060180187225342
        val_cross            315.8155212402344
        val_loss             92.57075500488281
      val_recon_tf          14.806909561157227
       val_spec_tf          181.07957458496094
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
